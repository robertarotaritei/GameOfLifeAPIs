‡1
FD:\School\GameOfLifeAPIs\UserAPI\UserAPI\Controllers\UserController.cs
	namespace 	
UserAPI
 
. 
Controllers 
{ 
[ 
ApiController 
] 
[		 
Route		 

(		
 
$str		 %
)		% &
]		& '
public

 

class

 
UserController

 
{ 
public 

IUserQuery 

_userQuery $
{% &
get' *
;* +
}, -
public 
UserController 
( 

IUserQuery (
	userQuery) 2
)2 3
{ 	

_userQuery 
= 
	userQuery "
;" #
} 	
[ 	
HttpGet	 
( 
$str 
) 
] 
public 
async 
Task 
< 
IActionResult '
>' (
GetOne) /
(/ 0
int0 3
id4 6
)6 7
{ 	
var 
result 
= 
await 

_userQuery )
.) *
FindOneAsync* 6
(6 7
id7 9
)9 :
;: ;
if 
( 
result 
is 
null 
) 
return 
new 
NotFoundResult )
() *
)* +
;+ ,
return 
new 
OkObjectResult %
(% &
result& ,
), -
;- .
} 	
[   	
HttpGet  	 
]   
[!! 	
Route!!	 
(!! 
$str!! 
)!! 
]!! 
public"" 
async"" 
Task"" 
<"" 
IActionResult"" '
>""' (
	VerifyOne"") 2
(""2 3
string""3 9
username"": B
,""B C
string""D J
password""K S
)""S T
{## 	
var$$ 
result$$ 
=$$ 
await$$ 

_userQuery$$ )
.$$) *
VerifyOneAsync$$* 8
($$8 9
username$$9 A
,$$A B
password$$C K
)$$K L
;$$L M
if&& 
(&& 
result&& 
is&& 
null&& 
)&& 
return'' 
new'' 
NotFoundResult'' )
('') *
)''* +
;''+ ,
return)) 
new)) 
OkObjectResult)) %
())% &
result))& ,
))), -
;))- .
}** 	
[-- 	
HttpGet--	 
]-- 
[.. 	
Route..	 
(.. 
$str.. 
)..  
]..  !
public// 
async// 
Task// 
<// 
IActionResult// '
>//' (
VerifyUsername//) 7
(//7 8
string//8 >
username//? G
)//G H
{00 	
var11 
result11 
=11 
await11 

_userQuery11 )
.11) *
VerifyUsernameAsync11* =
(11= >
username11> F
)11F G
;11G H
if33 
(33 
result33 
is33 
null33 
)33 
return44 
new44 
NotFoundResult44 )
(44) *
)44* +
;44+ ,
return66 
new66 
OkObjectResult66 %
(66% &
result66& ,
)66, -
;66- .
}77 	
[:: 	
HttpPost::	 
]:: 
public;; 
async;; 
Task;; 
<;; 
IActionResult;; '
>;;' (
Post;;) -
(;;- .
[;;. /
FromBody;;/ 7
];;7 8
User;;9 =
body;;> B
);;B C
{<< 	
var== 
result== 
=== 
await== 

_userQuery== )
.==) *
InsertAsync==* 5
(==5 6
body==6 :
)==: ;
;==; <
if?? 
(?? 
result?? 
is?? 
null?? 
)?? 
return@@ 
new@@ 
NotFoundResult@@ )
(@@) *
)@@* +
;@@+ ,
returnBB 
newBB 
OkObjectResultBB %
(BB% &
bodyBB& *
)BB* +
;BB+ ,
}CC 	
[FF 	
HttpPutFF	 
(FF 
$strFF 
)FF 
]FF 
publicGG 
asyncGG 
TaskGG 
<GG 
IActionResultGG '
>GG' (
PutOneGG) /
(GG/ 0
intGG0 3
idGG4 6
,GG6 7
[GG8 9
FromBodyGG9 A
]GGA B
stringGGC I
passwordGGJ R
)GGR S
{HH 	
varII 
resultII 
=II 
awaitII 

_userQueryII )
.II) *
UpdateAsyncII* 5
(II5 6
idII6 8
,II8 9
passwordII: B
)IIB C
;IIC D
ifKK 
(KK 
resultKK 
isKK 
nullKK 
)KK 
returnLL 
newLL 
NotFoundResultLL )
(LL) *
)LL* +
;LL+ ,
returnNN 
newNN 
OkObjectResultNN %
(NN% &
resultNN& ,
)NN, -
;NN- .
}OO 	
[RR 	

HttpDeleteRR	 
(RR 
$strRR 
)RR 
]RR 
publicSS 
asyncSS 
TaskSS 
<SS 
IActionResultSS '
>SS' (
	DeleteOneSS) 2
(SS2 3
intSS3 6
idSS7 9
)SS9 :
{TT 	
varUU 
resultUU 
=UU 
awaitUU 

_userQueryUU )
.UU) *
DeleteAsyncUU* 5
(UU5 6
idUU6 8
)UU8 9
;UU9 :
ifWW 
(WW 
resultWW 
isWW 
nullWW 
)WW 
returnXX 
newXX 
NotFoundResultXX )
(XX) *
)XX* +
;XX+ ,
returnZZ 
newZZ 
OkObjectResultZZ %
(ZZ% &
resultZZ& ,
)ZZ, -
;ZZ- .
}[[ 	
}\\ 
}]] î
@D:\School\GameOfLifeAPIs\UserAPI\UserAPI\Infrastructure\AppDb.cs
	namespace 	
UserAPI
 
{ 
public 

class 
AppDb 
: 
IDisposable $
{ 
public 
MySqlConnection 

Connection )
{* +
get, /
;/ 0
}1 2
public

 
AppDb

 
(

 
string

 
connectionString

 ,
)

, -
{ 	

Connection 
= 
new 
MySqlConnection ,
(, -
connectionString- =
)= >
;> ?
} 	
public 
void 
Dispose 
( 
) 
=>  

Connection! +
.+ ,
Dispose, 3
(3 4
)4 5
;5 6
} 
} †
ED:\School\GameOfLifeAPIs\UserAPI\UserAPI\Infrastructure\IUserQuery.cs
	namespace 	
UserAPI
 
. 
Infrastructure  
{		 
public

 

	interface

 

IUserQuery

 
{ 
Task 
< 
User 
> 
InsertAsync 
( 
User #
body$ (
)( )
;) *
Task 
< 
User 
> 
UpdateAsync 
( 
int "
id# %
,% &
string' -
password. 6
)6 7
;7 8
Task 
< 
User 
> 
DeleteAsync 
( 
int "
id# %
)% &
;& '
Task 
< 
User 
> 
FindOneAsync 
(  
int  #
id$ &
)& '
;' (
Task 
< 
User 
> 
VerifyOneAsync !
(! "
string" (
username) 1
,1 2
string3 9
password: B
)B C
;C D
Task 
< 
User 
> 
VerifyUsernameAsync &
(& '
string' -
username. 6
)6 7
;7 8
} 
} …
GD:\School\GameOfLifeAPIs\UserAPI\UserAPI\Infrastructure\SqlStatement.cs
	namespace 	
UserAPI
 
. 
Infrastructure  
{ 
public 

class 
SqlStatement 
{		 
public

 
string

 
InsertAsync

 !
{

" #
get

$ '
;

' (
}

) *
public 
string 
UpdateAsync !
{" #
get$ '
;' (
}) *
public 
string 
DeleteAsync !
{" #
get$ '
;' (
}) *
public 
string 
FindOneAsync "
{# $
get% (
;( )
}* +
public 
string 
VerifyOneAsync $
{% &
get' *
;* +
}- .
public 
string 
VerifyUsernameAsync )
{* +
get, /
;/ 0
}1 2
public 
SqlStatement 
( 
) 
{ 	
InsertAsync 
= 
$str h
;h i
UpdateAsync 
= 
$str W
;W X
DeleteAsync 
= 
$str A
;A B
FindOneAsync 
= 
$str C
;C D
VerifyOneAsync 
= 
$str m
;m n
VerifyUsernameAsync 
=  !
$str" X
;X Y
} 	
} 
}   êq
DD:\School\GameOfLifeAPIs\UserAPI\UserAPI\Infrastructure\UserQuery.cs
	namespace 	
UserAPI
 
. 
Models 
{		 
public

 

class

 
	UserQuery

 
:

 

IUserQuery

 '
{ 
public 
AppDb 
Db 
{ 
get 
; 
}  
public 
SqlStatement 
	Statement %
{& '
get( +
;+ ,
}- .
public 
	UserQuery 
( 
string 
connectionString  0
)0 1
{ 	
Db 
= 
new 
AppDb 
( 
connectionString +
)+ ,
;, -
	Statement 
= 
new 
SqlStatement (
(( )
)) *
;* +
} 	
public 
async 
Task 
< 
User 
> 
InsertAsync  +
(+ ,
User, 0
body1 5
)5 6
{ 	
if 
( 
body 
. 
Username 
. 
Length $
>% &
$num' (
&&) +
body, 0
.0 1
Password1 9
.9 :
Length: @
>A B
$numC D
)D E
{ 
await 
Db 
. 

Connection #
.# $
	OpenAsync$ -
(- .
). /
;/ 0
using 
var 
cmd 
= 
Db  "
." #

Connection# -
.- .
CreateCommand. ;
(; <
)< =
;= >
cmd 
. 
CommandText 
=  !
	Statement" +
.+ ,
InsertAsync, 7
;7 8

BindParams 
( 
cmd 
, 
body  $
.$ %
Username% -
,- .
body/ 3
.3 4
Password4 <
)< =
;= >
await 
cmd 
.  
ExecuteNonQueryAsync .
(. /
)/ 0
;0 1
body   
.   
Id   
=   
(   
int   
)   
cmd   "
.  " #
LastInsertedId  # 1
;  1 2
return!! 
body!! 
;!! 
}"" 
return$$ 
null$$ 
;$$ 
}%% 	
public'' 
async'' 
Task'' 
<'' 
User'' 
>'' 
UpdateAsync''  +
(''+ ,
int'', /
id''0 2
,''2 3
string''4 :
password''; C
)''C D
{(( 	
await)) 
Db)) 
.)) 

Connection)) 
.))  
	OpenAsync))  )
())) *
)))* +
;))+ ,
using** 
var** 
cmd** 
=** 
Db** 
.** 

Connection** )
.**) *
CreateCommand*** 7
(**7 8
)**8 9
;**9 :
cmd++ 
.++ 
CommandText++ 
=++ 
	Statement++ '
.++' (
UpdateAsync++( 3
;++3 4
BindPassword,, 
(,, 
cmd,, 
,,, 
password,, &
),,& '
;,,' (
BindId-- 
(-- 
cmd-- 
,-- 
id-- 
)-- 
;-- 
var.. 
result.. 
=.. 
await.. 
ReadAllAsync.. +
(..+ ,
await.., 1
cmd..2 5
...5 6
ExecuteReaderAsync..6 H
(..H I
)..I J
)..J K
;..K L
return00 
result00 
.00 
Count00 
>00  !
$num00" #
?00$ %
result00& ,
[00, -
$num00- .
]00. /
:000 1
null002 6
;006 7
}11 	
public33 
async33 
Task33 
<33 
User33 
>33 
DeleteAsync33  +
(33+ ,
int33, /
id330 2
)332 3
{44 	
var55 
body55 
=55 
await55 
FindOneAsync55 )
(55) *
id55* ,
)55, -
;55- .
using66 
var66 
cmd66 
=66 
Db66 
.66 

Connection66 )
.66) *
CreateCommand66* 7
(667 8
)668 9
;669 :
cmd77 
.77 
CommandText77 
=77 
	Statement77 '
.77' (
DeleteAsync77( 3
;773 4
BindId88 
(88 
cmd88 
,88 
id88 
)88 
;88 
await99 
cmd99 
.99  
ExecuteNonQueryAsync99 *
(99* +
)99+ ,
;99, -
return;; 
body;; 
;;; 
}<< 	
public>> 
async>> 
Task>> 
<>> 
User>> 
>>> 
FindOneAsync>>  ,
(>>, -
int>>- 0
id>>1 3
)>>3 4
{?? 	
await@@ 
Db@@ 
.@@ 

Connection@@ 
.@@  
	OpenAsync@@  )
(@@) *
)@@* +
;@@+ ,
usingAA 
varAA 
cmdAA 
=AA 
DbAA 
.AA 

ConnectionAA )
.AA) *
CreateCommandAA* 7
(AA7 8
)AA8 9
;AA9 :
cmdBB 
.BB 
CommandTextBB 
=BB 
	StatementBB '
.BB' (
FindOneAsyncBB( 4
;BB4 5
BindIdCC 
(CC 
cmdCC 
,CC 
idCC 
)CC 
;CC 
varDD 
resultDD 
=DD 
awaitDD 
ReadAllAsyncDD +
(DD+ ,
awaitDD, 1
cmdDD2 5
.DD5 6
ExecuteReaderAsyncDD6 H
(DDH I
)DDI J
)DDJ K
;DDK L
returnFF 
resultFF 
.FF 
CountFF 
>FF  !
$numFF" #
?FF$ %
resultFF& ,
[FF, -
$numFF- .
]FF. /
:FF0 1
nullFF2 6
;FF6 7
}GG 	
publicII 
asyncII 
TaskII 
<II 
UserII 
>II 
VerifyOneAsyncII  .
(II. /
stringII/ 5
usernameII6 >
,II> ?
stringII@ F
passwordIIG O
)IIO P
{JJ 	
awaitKK 
DbKK 
.KK 

ConnectionKK 
.KK  
	OpenAsyncKK  )
(KK) *
)KK* +
;KK+ ,
usingLL 
varLL 
cmdLL 
=LL 
DbLL 
.LL 

ConnectionLL )
.LL) *
CreateCommandLL* 7
(LL7 8
)LL8 9
;LL9 :
cmdMM 
.MM 
CommandTextMM 
=MM 
	StatementMM '
.MM' (
VerifyOneAsyncMM( 6
;MM6 7

BindParamsNN 
(NN 
cmdNN 
,NN 
usernameNN $
,NN$ %
passwordNN& .
)NN. /
;NN/ 0
varOO 
resultOO 
=OO 
awaitOO 
ReadAllAsyncOO +
(OO+ ,
awaitOO, 1
cmdOO2 5
.OO5 6
ExecuteReaderAsyncOO6 H
(OOH I
)OOI J
)OOJ K
;OOK L
returnQQ 
resultQQ 
.QQ 
CountQQ 
>QQ  !
$numQQ" #
?QQ$ %
resultQQ& ,
[QQ, -
$numQQ- .
]QQ. /
:QQ0 1
nullQQ2 6
;QQ6 7
}RR 	
publicTT 
asyncTT 
TaskTT 
<TT 
UserTT 
>TT 
VerifyUsernameAsyncTT  3
(TT3 4
stringTT4 :
usernameTT; C
)TTC D
{UU 	
awaitVV 
DbVV 
.VV 

ConnectionVV 
.VV  
	OpenAsyncVV  )
(VV) *
)VV* +
;VV+ ,
usingWW 
varWW 
cmdWW 
=WW 
DbWW 
.WW 

ConnectionWW )
.WW) *
CreateCommandWW* 7
(WW7 8
)WW8 9
;WW9 :
cmdXX 
.XX 
CommandTextXX 
=XX 
	StatementXX '
.XX' (
VerifyUsernameAsyncXX( ;
;XX; <
BindUsernameYY 
(YY 
cmdYY 
,YY 
usernameYY &
)YY& '
;YY' (
varZZ 
resultZZ 
=ZZ 
awaitZZ 
ReadAllAsyncZZ +
(ZZ+ ,
awaitZZ, 1
cmdZZ2 5
.ZZ5 6
ExecuteReaderAsyncZZ6 H
(ZZH I
)ZZI J
)ZZJ K
;ZZK L
return\\ 
result\\ 
.\\ 
Count\\ 
>\\  !
$num\\" #
?\\$ %
result\\& ,
[\\, -
$num\\- .
]\\. /
:\\0 1
null\\2 6
;\\6 7
}]] 	
private__ 
async__ 
Task__ 
<__ 
List__ 
<__  
User__  $
>__$ %
>__% &
ReadAllAsync__' 3
(__3 4
DbDataReader__4 @
reader__A G
)__G H
{`` 	
varaa 
usersaa 
=aa 
newaa 
Listaa  
<aa  !
Useraa! %
>aa% &
(aa& '
)aa' (
;aa( )
usingbb 
(bb 
readerbb 
)bb 
{cc 
whiledd 
(dd 
awaitdd 
readerdd #
.dd# $
	ReadAsyncdd$ -
(dd- .
)dd. /
)dd/ 0
{ee 
varff 
userff 
=ff 
newff "
Userff# '
(ff' (
)ff( )
{gg 
Idhh 
=hh 
readerhh #
.hh# $
GetInt32hh$ ,
(hh, -
$numhh- .
)hh. /
,hh/ 0
Usernameii  
=ii! "
readerii# )
.ii) *
	GetStringii* 3
(ii3 4
$numii4 5
)ii5 6
,ii6 7
Passwordjj  
=jj! "
readerjj# )
.jj) *
	GetStringjj* 3
(jj3 4
$numjj4 5
)jj5 6
,jj6 7
}kk 
;kk 
usersll 
.ll 
Addll 
(ll 
userll "
)ll" #
;ll# $
}mm 
}nn 
returnpp 
userspp 
;pp 
}qq 	
privatess 
voidss 
BindIdss 
(ss 
MySqlCommandss (
cmdss) ,
,ss, -
intss. 1
idss2 4
)ss4 5
{tt 	
cmduu 
.uu 

Parametersuu 
.uu 
Adduu 
(uu 
newuu "
MySqlParameteruu# 1
{vv 
ParameterNameww 
=ww 
$strww  %
,ww% &
DbTypexx 
=xx 
DbTypexx 
.xx  
Int32xx  %
,xx% &
Valueyy 
=yy 
idyy 
,yy 
}zz 
)zz 
;zz 
}{{ 	
private}} 
void}} 

BindParams}} 
(}}  
MySqlCommand}}  ,
cmd}}- 0
,}}0 1
string}}2 8
username}}9 A
,}}A B
string}}C I
password}}J R
)}}R S
{~~ 	
cmd 
. 

Parameters 
. 
Add 
( 
new "
MySqlParameter# 1
{
ÄÄ 
ParameterName
ÅÅ 
=
ÅÅ 
$str
ÅÅ  +
,
ÅÅ+ ,
DbType
ÇÇ 
=
ÇÇ 
DbType
ÇÇ 
.
ÇÇ  
String
ÇÇ  &
,
ÇÇ& '
Value
ÉÉ 
=
ÉÉ 
username
ÉÉ  
,
ÉÉ  !
}
ÑÑ 
)
ÑÑ 
;
ÑÑ 
cmd
ÖÖ 
.
ÖÖ 

Parameters
ÖÖ 
.
ÖÖ 
Add
ÖÖ 
(
ÖÖ 
new
ÖÖ "
MySqlParameter
ÖÖ# 1
{
ÜÜ 
ParameterName
áá 
=
áá 
$str
áá  +
,
áá+ ,
DbType
àà 
=
àà 
DbType
àà 
.
àà  
String
àà  &
,
àà& '
Value
ââ 
=
ââ 
password
ââ  
,
ââ  !
}
ää 
)
ää 
;
ää 
}
ãã 	
private
çç 
void
çç 
BindUsername
çç !
(
çç! "
MySqlCommand
çç" .
cmd
çç/ 2
,
çç2 3
string
çç4 :
username
çç; C
)
ççC D
{
éé 	
cmd
èè 
.
èè 

Parameters
èè 
.
èè 
Add
èè 
(
èè 
new
èè "
MySqlParameter
èè# 1
{
êê 
ParameterName
ëë 
=
ëë 
$str
ëë  +
,
ëë+ ,
DbType
íí 
=
íí 
DbType
íí 
.
íí  
String
íí  &
,
íí& '
Value
ìì 
=
ìì 
username
ìì  
,
ìì  !
}
îî 
)
îî 
;
îî 
}
ïï 	
private
óó 
void
óó 
BindPassword
óó !
(
óó! "
MySqlCommand
óó" .
cmd
óó/ 2
,
óó2 3
string
óó4 :
password
óó; C
)
óóC D
{
òò 	
cmd
ôô 
.
ôô 

Parameters
ôô 
.
ôô 
Add
ôô 
(
ôô 
new
ôô "
MySqlParameter
ôô# 1
{
öö 
ParameterName
õõ 
=
õõ 
$str
õõ  +
,
õõ+ ,
DbType
úú 
=
úú 
DbType
úú 
.
úú  
String
úú  &
,
úú& '
Value
ùù 
=
ùù 
password
ùù  
,
ùù  !
}
ûû 
)
ûû 
;
ûû 
}
üü 	
}
†† 
}°° §
7D:\School\GameOfLifeAPIs\UserAPI\UserAPI\Models\User.cs
	namespace 	
UserAPI
 
. 
Models 
{		 
public

 

class

 
User

 
{ 
public 
int 
Id 
{ 
get 
; 
set  
;  !
}" #
public 
string 
Username 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 
Password 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
User 
( 
) 
{ 	
} 	
} 
} à

3D:\School\GameOfLifeAPIs\UserAPI\UserAPI\Program.cs
	namespace

 	
UserAPI


 
{ 
public 

class 
Program 
{ 
public 
static 
void 
Main 
(  
string  &
[& '
]' (
args) -
)- .
{ 	
CreateHostBuilder 
( 
args "
)" #
.# $
Build$ )
() *
)* +
.+ ,
Run, /
(/ 0
)0 1
;1 2
} 	
public 
static 
IHostBuilder "
CreateHostBuilder# 4
(4 5
string5 ;
[; <
]< =
args> B
)B C
=>D F
Host 
.  
CreateDefaultBuilder %
(% &
args& *
)* +
. $
ConfigureWebHostDefaults )
() *

webBuilder* 4
=>5 7
{ 

webBuilder 
. 

UseStartup )
<) *
Startup* 1
>1 2
(2 3
)3 4
;4 5
} 
) 
; 
} 
} ˜
3D:\School\GameOfLifeAPIs\UserAPI\UserAPI\Startup.cs
	namespace 	
UserAPI
 
{ 
public 

class 
Startup 
{ 
readonly 
string "
MyAllowSpecificOrigins .
=/ 0
$str1 J
;J K
public 
Startup 
( 
IConfiguration %
configuration& 3
)3 4
{ 	
Configuration 
= 
configuration )
;) *
} 	
public 
IConfiguration 
Configuration +
{, -
get. 1
;1 2
}3 4
public 
void 
ConfigureServices %
(% &
IServiceCollection& 8
services9 A
)A B
{ 	
services   
.   
AddCors   
(   
options   $
=>  % '
{!! 
options"" 
."" 
	AddPolicy"" !
(""! "
name""" &
:""& '"
MyAllowSpecificOrigins""( >
,""> ?
builder##" )
=>##* ,
{$$" #
builder%%& -
.%%- .
WithOrigins%%. 9
(%%9 :
$str%%: Q
)%%Q R
;%%R S
}&&" #
)&&# $
;&&$ %
}'' 
)'' 
;'' 
services)) 
.)) 
AddControllers)) #
())# $
)))$ %
;))% &
services** 
.** 
AddTransient** !
<**! "

IUserQuery**" ,
,**, -
	UserQuery**. 7
>**7 8
(**8 9
_**9 :
=>**; =
new**> A
	UserQuery**B K
(**K L
Configuration**L Y
[**Y Z
$str**Z 
]	** Ä
)
**Ä Å
)
**Å Ç
;
**Ç É
}++ 	
public.. 
void.. 
	Configure.. 
(.. 
IApplicationBuilder.. 1
app..2 5
,..5 6
IWebHostEnvironment..7 J
env..K N
)..N O
{// 	
if00 
(00 
env00 
.00 
IsDevelopment00 !
(00! "
)00" #
)00# $
{11 
app22 
.22 %
UseDeveloperExceptionPage22 -
(22- .
)22. /
;22/ 0
}33 
app55 
.55 
UseHttpsRedirection55 #
(55# $
)55$ %
;55% &
app77 
.77 

UseRouting77 
(77 
)77 
;77 
app99 
.99 
UseCors99 
(99 "
MyAllowSpecificOrigins99 .
)99. /
;99/ 0
app;; 
.;; 
UseAuthorization;;  
(;;  !
);;! "
;;;" #
app== 
.== 
UseEndpoints== 
(== 
	endpoints== &
=>==' )
{>> 
	endpoints?? 
.?? 
MapControllers?? (
(??( )
)??) *
;??* +
}@@ 
)@@ 
;@@ 
}AA 	
}BB 
}CC 